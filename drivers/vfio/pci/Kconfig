# SPDX-License-Identifier: GPL-2.0-only
config VFIO_PCI_CORE
	tristate "VFIO core support for PCI devices"
	depends on VFIO && PCI && EVENTFD
	select VFIO_VIRQFD
	select IRQ_BYPASS_MANAGER
	help
	  Support for the PCI VFIO bus driver.  This is required to make
	  use of PCI drivers using the VFIO framework.

	  If you don't know what to do here, say N.

config VFIO_PCI
	tristate "VFIO support for PCI devices"
	depends on VFIO_PCI_CORE
	help
	  This provides a generic PCI support using the VFIO framework.

	  If you don't know what to do here, say N.

config VFIO_PCI_VGA
	bool "VFIO PCI support for VGA devices"
	depends on VFIO_PCI_CORE && X86 && VGA_ARB
	help
	  Support for VGA extension to VFIO PCI.  This exposes an additional
	  region on VGA devices for accessing legacy VGA addresses used by
	  BIOS and generic video drivers.

	  If you don't know what to do here, say N.

config VFIO_PCI_MMAP
	depends on VFIO_PCI_CORE
	def_bool y if !S390

config VFIO_PCI_INTX
	depends on VFIO_PCI_CORE
	def_bool y if !S390

config VFIO_PCI_IGD
	bool "VFIO PCI extensions for Intel graphics (GVT-d)"
	depends on VFIO_PCI_CORE && X86
	default y
	help
	  Support for Intel IGD specific extensions to enable direct
	  assignment to virtual machines.  This includes exposing an IGD
	  specific firmware table and read-only copies of the host bridge
	  and LPC bridge config space.

	  To enable Intel IGD assignment through vfio-pci, say Y.

config VFIO_PCI_NVLINK2GPU
	tristate "VFIO support for NVIDIA NVLINK2 GPUs"
	depends on VFIO_PCI_CORE && PPC_POWERNV
	help
	  VFIO PCI driver for NVIDIA NVLINK2 GPUs with specific extensions
	  for P9 Witherspoon machine.

config VFIO_PCI_NPU2
	tristate "VFIO support for IBM NPU host bus adapter on P9"
	depends on VFIO_PCI_NVLINK2GPU && PPC_POWERNV
	help
	  VFIO PCI specific extensions for IBM NVLink2 host bus adapter on P9
	  Witherspoon machine.

config VFIO_PCI_DRIVER_COMPAT
	bool "VFIO PCI backward compatibility for vendor specific extensions"
	default y
	depends on VFIO_PCI
	help
	  Say Y here if you want to preserve VFIO PCI backward
	  compatibility. vfio_pci.ko will continue to automatically use
	  the NVLINK2, NPU2 and IGD VFIO drivers when it is attached to
	  a compatible device.

	  When N is selected the user must bind explicity to the module
	  they want to handle the device and vfio_pci.ko will have no
	  device specific special behaviors.
